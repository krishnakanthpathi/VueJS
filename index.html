<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vue Expense Tracker</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-10 font-sans">

    <div id="app" class="max-w-md mx-auto bg-white p-6 rounded-xl shadow-lg">
        
        <div class="text-center mb-6">
            <h1 class="text-2xl font-bold text-gray-800">ðŸ’° Expense Tracker</h1>
            <div class="mt-2 text-3xl font-black" :class="totalBalance >= 0 ? 'text-green-600' : 'text-red-600'">
                ${{ totalBalance }}
            </div>
            <p class="text-gray-500 text-sm">Net Balance</p>
        </div>

        <div class="bg-gray-50 p-4 rounded-lg mb-6 border">
            <div class="flex flex-col gap-3">
                <input class="border p-2 rounded outline-none focus:ring-2 focus:ring-blue-400" 
                       type="text" 
                       placeholder="Description (e.g. Salary)" 
                       v-model="description"/>
                
                <div class="flex gap-2">
                    <input class="border p-2 rounded w-full outline-none focus:ring-2 focus:ring-blue-400" 
                           type="number" 
                           placeholder="0.00" 
                           v-model.number="amount"/>
                    
                    <select class="border p-2 rounded bg-white outline-none" v-model="type">
                        <option value="income">Income (+)</option>
                        <option value="expense">Expense (-)</option>
                    </select>
                </div>

                <button class="bg-blue-600 text-white font-bold p-2 rounded hover:bg-blue-700 transition" 
                        @click="addExpense">
                    Add Transaction
                </button>
            </div>
        </div>

        <div class="flex justify-between items-center mb-4">
            <h3 class="font-bold text-gray-700">History</h3>
            <select v-model="filterType" class="text-sm border p-1 rounded bg-gray-50">
                <option value="all">Show All</option>
                <option value="income">Income Only</option>
                <option value="expense">Expense Only</option>
            </select>
        </div>

        <ul class="space-y-3">
            <li v-for="item in filteredList" :key="item.id" 
                class="flex justify-between items-center p-3 bg-white border-l-4 shadow-sm rounded"
                :class="item.amount >= 0 ? 'border-green-500' : 'border-red-500'">
                
                <div class="flex flex-col">
                    <span class="font-medium text-gray-800">{{ item.description }}</span>
                    <span class="text-xs text-gray-400">
                        {{ item.amount >= 0 ? 'Income' : 'Expense' }}
                    </span>
                </div>

                <div class="flex items-center gap-4">
                    <span class="font-bold" :class="item.amount >= 0 ? 'text-green-600' : 'text-red-600'">
                        {{ item.amount >= 0 ? '+' : '' }}${{ Math.abs(item.amount) }}
                    </span>
                    <button @click="removeExpense(item.id)" class="text-gray-300 hover:text-red-500 transition">
                        âœ•
                    </button>
                </div>
            </li>
        </ul>

        <p v-if="filteredList.length === 0" class="text-center text-gray-400 mt-6 italic">
            No transactions found.
        </p>

    </div>

    <script type="module">
        
        const { createApp, ref, computed, watch , onMounted } = Vue;

        createApp({
            setup() {
                // --- STATE ---
                const description = ref('');
                const amount = ref(null);
                const type = ref('expense');
                const filterType = ref('all');
                const expenses = ref([]);

                // --- ACTIONS ---
                function addExpense() {
                    if (description.value && amount.value !== null) {
                        // Math logic: make expense negative, income positive
                        let finalAmount = type.value === 'income' 
                            ? Math.abs(amount.value) 
                            : -Math.abs(amount.value);

                        expenses.value.push({
                            id: Date.now(), // Unique ID (timestamp)
                            description: description.value,
                            amount: finalAmount
                        });

                        // Reset form
                        description.value = '';
                        amount.value = null;
                        type.value = 'expense';
                    }
                }

                function removeExpense(idToDelete) {
                    expenses.value = expenses.value.filter(item => item.id !== idToDelete);
                }

                // --- COMPUTED (The Smart Logic) ---
                
                // 1. Calculate Total Balance
                const totalBalance = computed(() => {
                    return expenses.value.reduce((sum, item) => sum + item.amount, 0);
                });

                // 2. Filter the list for the View
                const filteredList = computed(() => {
                    if (filterType.value === 'all') return expenses.value;

                    return expenses.value.filter(item => {
                        if (filterType.value === 'income') return item.amount > 0;
                        if (filterType.value === 'expense') return item.amount < 0;
                    });
                });

                // --- PERSISTENCE (LocalStorage) ---
                
                // Save whenever expenses change
                watch(expenses, (newVal) => {
                    localStorage.setItem('my-vue-tracker', JSON.stringify(newVal));
                }, { deep: true });

                // Load when app starts
                onMounted(() => {
                    const saved = localStorage.getItem('my-vue-tracker');
                    if (saved) {
                        expenses.value = JSON.parse(saved);
                    }
                });

                // --- EXPOSE TO TEMPLATE ---
                return {
                    description, amount, type, expenses, filterType, // State
                    addExpense, removeExpense,                       // Actions
                    totalBalance, filteredList                       // Computed
                };
            }
        }).mount('#app');
    </script>
</body>
</html>