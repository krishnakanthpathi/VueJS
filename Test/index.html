<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task 2 - CRUD (Options API)</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50">
    
    <div id="app" class="p-8">
        <div class="max-w-7xl mx-auto bg-white rounded-lg shadow-lg overflow-hidden">
            
            <div class="p-6 bg-gray-100 border-b border-gray-200">
                <h2 class="text-xl font-bold mb-4 text-gray-700">User Management</h2>
                
                <button @click="openModelAddUser" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded shadow transition font-semibold">
                    + Add User
                </button>

                <div v-if="showModal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50">
                    <div class="bg-white rounded-lg shadow-lg p-6 w-full max-w-4xl mx-4">
                        <h2 class="text-xl font-bold mb-4 text-gray-700">{{ modelText }}</h2>
                        
                        <form @submit.prevent="editingIndex >= 0 ? updateUser() : addUser()" class="space-y-4">
                            <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4">
                                
                                <input v-model="form.name" type="text" placeholder="Name" 
                                       class="border p-2 rounded outline-none focus:ring-2 focus:ring-blue-400 w-full" required/>
                                
                                <input v-model="form.email" type="email" placeholder="Email" 
                                       class="border p-2 rounded outline-none focus:ring-2 focus:ring-blue-400 w-full" required/>
                                
                                <input v-model="form.dob" type="date" placeholder="Date of Birth" 
                                       class="border p-2 rounded outline-none focus:ring-2 focus:ring-blue-400 w-full" required/>
                                
                                <input v-model="form.mobile" type="tel" placeholder="Mobile Number" 
                                       class="border p-2 rounded outline-none focus:ring-2 focus:ring-blue-400 w-full" required/>
                                
                                <input v-model="form.address" type="text" placeholder="Address" 
                                       class="border p-2 rounded outline-none focus:ring-2 focus:ring-blue-400 w-full" />
                                
                                <select v-model="form.gender" 
                                        class="border p-2 rounded outline-none focus:ring-2 focus:ring-blue-400 w-full bg-white" required>
                                    <option value="" disabled>Select Gender</option>
                                    <option value="Male">Male</option>
                                    <option value="Female">Female</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>

                            <div class="flex justify-end">
                                <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded shadow transition font-semibold">
                                    {{ modelText }}   
                                </button>
                                <button type="button" @click="showModal = false" class="ml-2 bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded">
                                    Cancel
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <div class="overflow-x-auto">
                <table class="w-full text-sm text-left text-gray-600">
                    <thead class="bg-gradient-to-r from-blue-500 to-blue-600 text-white uppercase text-xs">
                        <tr>
                            <th class="px-6 py-3">#</th>
                            <th class="px-6 py-3">Name</th>
                            <th class="px-6 py-3">Email</th>
                            <th class="px-6 py-3">DOB</th>
                            <th class="px-6 py-3">Mobile</th>
                            <th class="px-6 py-3">Address</th>
                            <th class="px-6 py-3">Gender</th>
                            <th class="px-6 py-3 text-center">Actions</th>
                        </tr>
                    </thead>

                    <tbody>
                        <tr v-for="(user, index) in users" :key="index" class="border-b hover:bg-gray-50 transition">
                            <td class="px-6 py-4 font-bold">{{ index + 1 }}</td>
                            <td class="px-6 py-4">{{ user.name }}</td>
                            <td class="px-6 py-4">{{ user.email }}</td>
                            <td class="px-6 py-4 whitespace-nowrap">{{ user.dob }}</td>
                            <td class="px-6 py-4">{{ user.mobile }}</td>
                            <td class="px-6 py-4">{{ user.address }}</td>
                            <td class="px-6 py-4">
                                <span :class="{'bg-blue-100 text-blue-800': user.gender === 'Male', 'bg-pink-100 text-pink-800': user.gender === 'Female'}"
                                    class="px-2 py-1 rounded text-xs font-semibold bg-gray-100 text-gray-800">
                                    {{ user.gender }}
                                </span>
                            </td>
                            <td class="px-6 py-4 text-center whitespace-nowrap">
                                <button @click="toggleUpdate(index)" class="bg-yellow-500 hover:bg-yellow-600 text-white px-3 py-1 rounded text-xs mr-2 transition">
                                    Edit
                                </button>
                                <button @click="deleteUser(index)" class="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-xs transition">
                                    Delete
                                </button>
                            </td>
                        </tr>
                        <tr v-if="users.length === 0">
                            <td colspan="8" class="text-center py-8 text-gray-400">No records found.</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

</body>

<script>
    const { createApp } = Vue;

    createApp({
        // 1. DATA: Holds all your state variables
        data() {
            return {
                users: [
                    { name: 'John Doe', email: 'john.doe@example.com', dob: '1990-01-01', mobile: '1234567890', address: '123 Main St', gender: 'Male' },
                    { name: 'Jane Smith', email: 'jane.smith@example.com', dob: '1992-02-02', mobile: '9876543210', address: '456 Elm St', gender: 'Female' }
                ],
                showModal: false,
                modelText: 'Add User',
                editingIndex: -1,
                form: {
                    name: '',
                    email: '',
                    dob: '',
                    mobile: '',
                    address: '',
                    gender: ''
                }
            };
        },

        // 2. METHODS: Holds all your functions
        methods: {
            
            // Open Add Modal
            openModelAddUser() {
                this.resetForm();
                this.editingIndex = -1;
                this.modelText = 'Add User';
                this.showModal = true;
            },

            // Add User Logic
            addUser() {
                // Validation
                if (!this.form.name || !this.form.email) {
                    alert("Please fill in all required fields.");
                    return;
                }

                // Push NEW object to array
                this.users.push({ ...this.form });

                this.showModal = false;
                this.resetForm();
            },

            // Open Edit Modal
            toggleUpdate(index) {
                // Populate form with existing user data
                // We use { ... } to create a copy so we don't edit the table directly while typing
                this.form = { ...this.users[index] };

                this.editingIndex = index;
                this.modelText = 'Edit User';
                this.showModal = true;
            },

            // Update User Logic
            updateUser() {
                // Save changes to the specific index
                this.users[this.editingIndex] = { ...this.form };

                this.showModal = false;
                this.resetForm();
                this.editingIndex = -1;
            },

            // Delete User Logic
            deleteUser(index) {
                if (confirm("Are you sure you want to delete this user?")) {
                    this.users.splice(index, 1); // Use splice, not pop
                    
                    // If deleting the user currently being edited, reset
                    if (this.editingIndex === index) {
                        this.editingIndex = -1;
                    }
                }
            },

            // Helper to clear form
            resetForm() {
                this.form = {
                    name: '',
                    email: '',
                    dob: '',
                    mobile: '',
                    address: '',
                    gender: ''
                };
            }
        }
    }).mount('#app');
</script>
</html>